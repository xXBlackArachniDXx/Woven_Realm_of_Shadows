const app=document.getElementById('main');document.addEventListener('DOMContentLoaded',()=>{const y=document.getElementById('year');if(y)y.textContent=new Date().getFullYear()});const sections=[{id:'tattoo_flash',title:'Tattoo Flash & Sketches',desc:'Original flash sheets and custom sketches ‚Äî tattoo-ready artwork.',icon:'üïØÔ∏è',products:[{id:'tf1',title:'Moon Dagger Flash',price:14,stock:12,thumbnail:'assets/microbe.svg',printify_url:''},{id:'tf2',title:'Raven Skull Study',price:45,stock:3,thumbnail:'assets/spider.svg',printify_url:''}]},{id:'kitchen',title:'Cheeky Kitchen Decor',desc:'Playful gothic pieces for kitchens ‚Äî tea towels, prints, coasters.',icon:'üçΩÔ∏è',products:[{id:'k1',title:'Sinister Spoon Tea Towel',price:22,stock:9,thumbnail:'assets/microscope.svg',printify_url:'#'},{id:'k2',title:'Creepy Coasters Set',price:18,stock:0,thumbnail:'assets/web-pattern.svg',printify_url:'#'}]},{id:'microbial',title:'Microbial Art Prints',desc:'Microscopy-inspired prints mixing science and gothic aesthetics.',icon:'üî¨',products:[{id:'m1',title:'Stained Petri #7',price:30,stock:5,thumbnail:'assets/microbe.svg',printify_url:'#'},{id:'m2',title:'Microscope Study: Hemato',price:48,stock:1,thumbnail:'assets/microscope.svg',printify_url:''}]},{id:'merch',title:'Branded Clothing & Merchandise',desc:'Hoodies, shirts, pins, and hats ‚Äî gothic logos and illustrated designs.',icon:'üß•',products:[{id:'c1',title:'Guild Hoodie (black)',price:56,stock:15,thumbnail:'assets/spider.svg',printify_url:'#'},{id:'c2',title:'Emblem Tee (gold)',price:28,stock:7,thumbnail:'assets/web-pattern.svg',printify_url:'#'}]}];const savedStock=JSON.parse(localStorage.getItem('gothic_stock')||'{}');const wishlist=new Set(JSON.parse(localStorage.getItem('gothic_wishlist')||'[]'));if(savedStock&&typeof savedStock==='object'){sections.forEach(sec=>sec.products.forEach(p=>{if(savedStock[p.id]!==undefined)p.stock=savedStock[p.id]}))}function router(){const hash=location.hash||'#/';if(hash==='#/'||hash==='')return renderHome();if(hash.startsWith('#/section/'))return renderSection(hash.split('#/section/')[1]);if(hash.startsWith('#/product/'))return renderProduct(hash.split('#/product/')[1]);if(hash==='#/malwear')return renderMalwear();if(hash==='#/commission')return renderCommission();renderNotFound()}function el(t,a={},c=''){const e=document.createElement(t);for(let k in a){if(k==='class')e.className=a[k];else if(k==='style')e.style.cssText=a[k];else if(k.startsWith('on')&&typeof a[k]==='function')e.addEventListener(k.substring(2),a[k]);else e.setAttribute(k,a[k])}if(typeof c==='string')e.innerHTML=c;else if(c instanceof Node)e.appendChild(c);else if(Array.isArray(c))c.forEach(x=>e.appendChild(typeof x==='string'?document.createTextNode(x):x));return e}function money(n){return`$${n.toFixed(2)}`}document.addEventListener('mousemove',e=>{document.querySelectorAll('.card').forEach(card=>{const r=card.getBoundingClientRect();const mx=e.clientX-r.left;const my=e.clientY-r.top;card.style.setProperty('--mx',mx+'px');card.style.setProperty('--my',my+'px')})});function renderHome(){app.innerHTML='';const grid=el('div',{class:'section-grid'});sections.forEach(s=>{const card=el('button',{class:'card',onclick:()=>location.hash='#/section/'+s.id,'aria-label':s.title});const icon=el('div',{class:'icon'},s.icon);const h=el('h3',{},s.title);const p=el('p',{},s.desc);card.appendChild(icon);card.appendChild(h);card.appendChild(p);grid.appendChild(card)});const commCard=el('button',{class:'card',onclick:()=>location.hash='#/commission','aria-label':'Commission a Piece'});commCard.innerHTML=`<div class="icon">‚úíÔ∏è</div><h3>Commission a Piece</h3><p>Custom work ‚Äî tattoo designs, prints, microbial studies.</p>`;grid.appendChild(commCard);const malCard=el('button',{class:'card',onclick:()=>location.hash='#/malwear','aria-label':'Malwear'});malCard.innerHTML=`<div class="icon">üíª</div><h3>Malwear</h3><p>Hacker-inspired QR drops. Cyber-goth streetwear.</p>`;grid.appendChild(malCard);app.appendChild(grid)}function renderSection(id){const sect=sections.find(s=>s.id===id);if(!sect)return renderNotFound();app.innerHTML='';const header=el('div',{style:'display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px'});header.appendChild(el('div',{},[el('h2',{},sect.title),el('p',{style:'color:var(--muted);margin:6px 0 0 0'},sect.desc)]));app.appendChild(header);const wrap=el('div',{class:'products'});sect.products.forEach(p=>{const product=el('article',{class:'product',role:'article'});const thumb=el('div',{class:'thumb','aria-hidden':'true'});const img=el('img',{src:p.thumbnail,alt:p.title});thumb.appendChild(img);const meta=el('div',{class:'meta'},[el('h4',{},p.title),el('p',{},money(p.price))]);const actions=el('div',{class:'actions'});const viewBtn=el('button',{class:'btn',onclick:()=>location.hash='#/product/'+p.id},'View');const buyBtn=el('button',{class:(p.stock>0?'btn':'btn out'),onclick:()=>handleBuy(p),disabled:p.stock<=0},p.stock>0?'Buy':'Out of stock');actions.appendChild(viewBtn);actions.appendChild(buyBtn);product.appendChild(thumb);product.appendChild(meta);product.appendChild(actions);wrap.appendChild(product)});app.appendChild(wrap)}function findProduct(id){for(const s of sections)for(const p of s.products)if(p.id===id)return{product:p,section:s};return null}function renderProduct(id){const found=findProduct(id);if(!found)return renderNotFound();const p=found.product;app.innerHTML='';const container=el('div',{class:'product-detail'});const hero=el('div',{class:'hero'});hero.innerHTML=`<div class="big-thumb" aria-hidden="true"><img src="${p.thumbnail}" alt="${p.title}"></div><div class="info"><h2 style="color:var(--gold);margin:0">${p.title}</h2><div class="price">${money(p.price)}</div><div class="stock" id="stock-${p.id}">${p.stock>0?'In stock: '+p.stock:'<span style=\'color:#ff6b6b\'>Out of stock</span>'}</div><p style="color:var(--muted);margin-top:12px">Description placeholder.</p><div style="margin-top:14px;display:flex;gap:8px;flex-wrap:wrap"><button id="buyBtn" class="${p.stock>0?'btn':'btn out'}" ${p.stock>0?'':'disabled'}>${p.stock>0?'Buy (Open Printify)':'Out of stock'}</button></div></div>`;container.appendChild(hero);app.appendChild(container);document.getElementById('buyBtn').addEventListener('click',()=>handleBuy(p))}function renderCommission(){app.innerHTML=`<div style="padding:28px"><h2 style="color:var(--gold)">Commission a Piece</h2><p style="color:var(--muted)">Fill the form below and I'll reply soon.</p><form onsubmit="event.preventDefault(); alert('Request sent');" style="display:grid;gap:10px;max-width:600px"><input class="input" placeholder="Your name" required /><input class="input" placeholder="Email" type="email" required /><textarea class="input" placeholder="Describe your idea"></textarea><button class="btn" type="submit">Send request</button></form></div>`}function renderMalwear(){app.innerHTML='';const page=el('div',{class:'malwear-page'});const hero=el('section',{class:'malwear-hero'});hero.innerHTML=`<h2>Malwear ‚Äî Streetwear from the Atelier of Shadows</h2><p style="color:var(--muted);margin:6px 0 10px 0">Hacker-inspired QR drops. Cyber-goth energy. Built for the different.</p><div style="display:flex;gap:8px;flex-wrap:wrap"><a class="btn" href="#/malwear#shop" onclick="event.stopPropagation()">Shop Drop</a><a class="btn alt" href="https://www.tiktok.com/@yourhandle" target="_blank" rel="noopener">Join TikTok Live</a></div>`;page.appendChild(hero);const caps=el('div',{class:'capsules'});[{title:'Guild Hoodies',img:'assets/malwear/hoodie.svg'},{title:'Emblem Tees',img:'assets/malwear/tee.svg'},{title:'Accessories',img:'assets/malwear/beanie.svg'},{title:'Live Drop Exclusives',img:'assets/malwear/pin.svg'}].forEach(c=>{const cap=el('div',{class:'capsule',onclick:()=>document.getElementById('mal-grid').scrollIntoView({behavior:'smooth'})});cap.innerHTML=`<img src="${c.img}" alt=""><div style="color:var(--white);font-weight:600">${c.title}</div>`;caps.appendChild(cap)});page.appendChild(caps);const grid=el('div',{id:'mal-grid',class:'products'});[{id:'mw1',title:'Guild Hoodie ‚Äî Black',price:56,stock:12,thumbnail:'assets/malwear/hoodie.svg',printify_url:'#'},{id:'mw2',title:'Emblem Tee ‚Äî Gold',price:28,stock:7,thumbnail:'assets/malwear/tee.svg',printify_url:'#'},{id:'mw3',title:'Beanie ‚Äî Crest',price:22,stock:5,thumbnail:'assets/malwear/beanie.svg',printify_url:'#'},{id:'mw4',title:'Enamel Pin ‚Äî Spider',price:12,stock:0,thumbnail:'assets/malwear/pin.svg',printify_url:'#'}].forEach(p=>{const card=el('article',{class:'product'});const thumb=el('div',{class:'thumb'},el('img',{src:p.thumbnail,alt:p.title}));const meta=el('div',{class:'meta'},[el('h4',{},p.title),el('p',{},money(p.price))]);const actions=el('div',{class:'actions'});const buyBtn=el('button',{class:(p.stock>0?'btn':'btn out'),onclick:()=>handleBuy(p),disabled:p.stock<=0},p.stock>0?'Buy':'Out of stock');actions.appendChild(buyBtn);card.appendChild(thumb);card.appendChild(meta);card.appendChild(actions);grid.appendChild(card)});page.appendChild(grid);const lb=el('div',{class:'lookbook'});['look1.svg','look2.svg','look3.svg'].forEach(n=>lb.appendChild(el('img',{src:`assets/malwear/${n}`,alt:'Malwear look'})));page.appendChild(lb);const banner=el('div',{style:'margin-top:16px;padding:12px;border:1px solid rgba(140,63,255,.25);border-radius:10px;background:rgba(140,63,255,.06)'});banner.innerHTML=`<strong style="color:var(--mal-violet)">Next Malwear drop:</strong> Follow <a href="https://www.tiktok.com/@yourhandle" target="_blank">@yourhandle</a> for live date.`;page.appendChild(banner);app.appendChild(page)}function handleBuy(product){if(product.stock<=0){alert('This item is out of stock.');return}if(product.printify_url&&product.printify_url.length>1)window.open(product.printify_url,'_blank','noopener')}const CorsetEntry={start(onDone){if(!window.CORSET_ENABLED)return onDone&&onDone();const layer=document.getElementById('corset-entry');if(!layer)return onDone&&onDone();layer.classList.add('active');const btn=layer.querySelector('.corset-open-btn');const open=()=>{layer.classList.add('open');setTimeout(()=>{layer.classList.remove('active','open');layer.style.display='none';onDone&&onDone()},1100)};btn.addEventListener('click',open,{once:true})}};function renderNotFound(){app.innerHTML='<div style="padding:28px"><h2 style="color:#d4af37">Not Found</h2><p style="color:#b7b7b7">The page you requested was not found.</p></div>'}window.addEventListener('hashchange',router);window.addEventListener('load',router);